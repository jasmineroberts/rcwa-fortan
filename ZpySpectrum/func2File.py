# -*- coding: utf-8 -*-
"""
Created on Thu Jun 10 20:03:01 2021

@author: jasmineroberts
"""
from numpy import *
from time import time
from scipy.io import loadmat
import scipy
from copy import deepcopy
import cmath
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.colors import LogNorm


def Ag(lambdaX):
    A = A = array([[ 0.2   ,  1.072 ,  1.24  ],
       [ 0.2033,  1.098 ,  1.26  ],
       [ 0.2066,  1.125 ,  1.27  ],
       [ 0.2138,  1.173 ,  1.29  ],
       [ 0.2214,  1.208 ,  1.3   ],
       [ 0.2296,  1.238 ,  1.31  ],
       [ 0.2384,  1.265 ,  1.33  ],
       [ 0.248 ,  1.298 ,  1.35  ],
       [ 0.253 ,  1.32  ,  1.35  ],
       [ 0.2583,  1.343 ,  1.35  ],
       [ 0.2638,  1.372 ,  1.35  ],
       [ 0.2695,  1.404 ,  1.33  ],
       [ 0.2755,  1.441 ,  1.31  ],
       [ 0.2818,  1.476 ,  1.26  ],
       [ 0.2883,  1.502 ,  1.19  ],
       [ 0.2952,  1.519 ,  1.08  ],
       [ 0.2988,  1.522 ,  0.992 ],
       [ 0.3024,  1.496 ,  0.882 ],
       [ 0.3061,  1.432 ,  0.766 ],
       [ 0.31  ,  1.323 ,  0.647 ],
       [ 0.3115,  1.246 ,  0.586 ],
       [ 0.3139,  1.149 ,  0.54  ],
       [ 0.3155,  1.044 ,  0.514 ],
       [ 0.3179,  0.932 ,  0.504 ],
       [ 0.3195,  0.815 ,  0.526 ],
       [ 0.322 ,  0.708 ,  0.565 ],
       [ 0.3237,  0.616 ,  0.609 ],
       [ 0.3263,  0.526 ,  0.663 ],
       [ 0.3306,  0.371 ,  0.813 ],
       [ 0.3324,  0.321 ,  0.902 ],
       [ 0.3351,  0.294 ,  0.986 ],
       [ 0.3397,  0.259 ,  1.12  ],
       [ 0.3444,  0.238 ,  1.24  ],
       [ 0.3542,  0.209 ,  1.44  ],
       [ 0.3647,  0.186 ,  1.61  ],
       [ 0.3757,  0.2   ,  1.67  ],
       [ 0.3875,  0.192 ,  1.81  ],
       [ 0.4   ,  0.173 ,  1.95  ],
       [ 0.4133,  0.173 ,  2.11  ],
       [ 0.4275,  0.16  ,  2.26  ],
       [ 0.4428,  0.157 ,  2.4   ],
       [ 0.4592,  0.144 ,  2.56  ],
       [ 0.4769,  0.132 ,  2.72  ],
       [ 0.4959,  0.13  ,  2.88  ],
       [ 0.5166,  0.13  ,  3.07  ],
       [ 0.5391,  0.129 ,  3.25  ],
       [ 0.5636,  0.12  ,  3.45  ],
       [ 0.5904,  0.121 ,  3.66  ],
       [ 0.6199,  0.131 ,  3.88  ],
       [ 0.6526,  0.14  ,  4.15  ],
       [ 0.6888,  0.14  ,  4.44  ],
       [ 0.7293,  0.148 ,  4.74  ],
       [ 0.7749,  0.143 ,  5.09  ],
       [ 0.8266,  0.145 ,  5.5   ],
       [ 0.8856,  0.163 ,  5.95  ],
       [ 0.9537,  0.198 ,  6.43  ],
       [ 1.033 ,  0.226 ,  6.99  ],
       [ 1.127 ,  0.251 ,  7.67  ],
       [ 1.265 ,  0.375 ,  7.78  ],
       [ 1.291 ,  0.383 ,  7.92  ],
       [ 1.319 ,  0.392 ,  8.06  ],
       [ 1.348 ,  0.401 ,  8.21  ],
       [ 1.378 ,  0.411 ,  8.37  ],
       [ 1.409 ,  0.421 ,  8.37  ],
       [ 1.442 ,  0.431 ,  8.7   ],
       [ 1.476 ,  0.442 ,  8.88  ],
       [ 1.512 ,  0.455 ,  9.08  ],
       [ 1.55  ,  0.469 ,  9.32  ],
       [ 1.59  ,  0.485 ,  9.57  ],
       [ 1.631 ,  0.501 ,  9.84  ],
       [ 1.675 ,  0.519 , 10.1   ],
       [ 1.722 ,  0.537 , 10.4   ],
       [ 1.771 ,  0.557 , 10.7   ],
       [ 1.823 ,  0.578 , 11.1   ],
       [ 1.879 ,  0.6   , 11.4   ],
       [ 1.937 ,  0.624 , 11.8   ],
       [ 2.    ,  0.65  , 12.2   ],
       [ 2.066 ,  0.668 , 12.6   ],
       [ 2.138 ,  0.729 , 13.    ],
       [ 2.214 ,  0.774 , 13.5   ],
       [ 2.296 ,  0.823 , 14.    ],
       [ 2.384 ,  0.878 , 14.5   ],
       [ 2.48  ,  0.939 , 15.1   ],
       [ 2.583 ,  1.007 , 15.7   ],
       [ 2.695 ,  1.083 , 16.4   ],
       [ 2.818 ,  1.168 , 17.1   ],
       [ 2.952 ,  1.265 , 17.9   ],
       [ 3.1   ,  1.387 , 18.8   ],
       [ 3.263 ,  1.536 , 19.8   ],
       [ 3.444 ,  1.71  , 20.9   ],
       [ 3.647 ,  1.915 , 22.1   ],
       [ 3.875 ,  2.16  , 23.5   ],
       [ 4.133 ,  2.446 , 25.1   ],
       [ 4.428 ,  2.786 , 26.9   ],
       [ 4.769 ,  3.202 , 29.    ],
       [ 5.166 ,  3.732 , 31.3   ],
       [ 5.636 ,  4.425 , 34.    ],
       [ 6.199 ,  5.355 , 37.    ],
       [ 6.526 ,  5.96  , 38.6   ],
       [ 6.888 ,  6.67  , 40.4   ],
       [ 7.293 ,  7.461 , 42.5   ],
       [ 7.749 ,  8.376 , 44.8   ],
       [ 8.266 ,  9.441 , 47.1   ],
       [ 8.856 , 10.69  , 49.4   ],
       [ 9.537 , 12.21  , 52.2   ],
       [ 9.919 , 13.11  , 53.7   ]])
    
    lam=A[:,0]
    kap=A[:,2]
    ref=A[:,1]
    if lambdaX<lam[0] or lambdaX>lam[-1]:
            y=0
    else:
        ind=where(lam>=lambdaX)[0]
        wave_R=lam[ind[0]]
        if ind[0]==1:
            n=ref[0]
            k=kap[0]
        else:
            wave_L=lam[ind[0]-1]
            n=(ref[ind[0]]-ref[ind[0]-1])/(wave_R-wave_L)*(lambdaX-wave_L)+ref[ind[0]-1];
            k=(kap[ind[0]]-kap[ind[0]-1])/(wave_R-wave_L)*(lambdaX-wave_L)+kap[ind[0]-1];
            
    return (n+ complex(0,1) *k)**2





def Al(lambdaX):
    A = array([[ 0.2   ,  1.072 ,  1.24  ],
       [ 0.2033,  1.098 ,  1.26  ],
       [ 0.2066,  1.125 ,  1.27  ],
       [ 0.2138,  1.173 ,  1.29  ],
       [ 0.2214,  1.208 ,  1.3   ],
       [ 0.2296,  1.238 ,  1.31  ],
       [ 0.2384,  1.265 ,  1.33  ],
       [ 0.248 ,  1.298 ,  1.35  ],
       [ 0.253 ,  1.32  ,  1.35  ],
       [ 0.2583,  1.343 ,  1.35  ],
       [ 0.2638,  1.372 ,  1.35  ],
       [ 0.2695,  1.404 ,  1.33  ],
       [ 0.2755,  1.441 ,  1.31  ],
       [ 0.2818,  1.476 ,  1.26  ],
       [ 0.2883,  1.502 ,  1.19  ],
       [ 0.2952,  1.519 ,  1.08  ],
       [ 0.2988,  1.522 ,  0.992 ],
       [ 0.3024,  1.496 ,  0.882 ],
       [ 0.3061,  1.432 ,  0.766 ],
       [ 0.31  ,  1.323 ,  0.647 ],
       [ 0.3115,  1.246 ,  0.586 ],
       [ 0.3139,  1.149 ,  0.54  ],
       [ 0.3155,  1.044 ,  0.514 ],
       [ 0.3179,  0.932 ,  0.504 ],
       [ 0.3195,  0.815 ,  0.526 ],
       [ 0.322 ,  0.708 ,  0.565 ],
       [ 0.3237,  0.616 ,  0.609 ],
       [ 0.3263,  0.526 ,  0.663 ],
       [ 0.3306,  0.371 ,  0.813 ],
       [ 0.3324,  0.321 ,  0.902 ],
       [ 0.3351,  0.294 ,  0.986 ],
       [ 0.3397,  0.259 ,  1.12  ],
       [ 0.3444,  0.238 ,  1.24  ],
       [ 0.3542,  0.209 ,  1.44  ],
       [ 0.3647,  0.186 ,  1.61  ],
       [ 0.3757,  0.2   ,  1.67  ],
       [ 0.3875,  0.192 ,  1.81  ],
       [ 0.4   ,  0.173 ,  1.95  ],
       [ 0.4133,  0.173 ,  2.11  ],
       [ 0.4275,  0.16  ,  2.26  ],
       [ 0.4428,  0.157 ,  2.4   ],
       [ 0.4592,  0.144 ,  2.56  ],
       [ 0.4769,  0.132 ,  2.72  ],
       [ 0.4959,  0.13  ,  2.88  ],
       [ 0.5166,  0.13  ,  3.07  ],
       [ 0.5391,  0.129 ,  3.25  ],
       [ 0.5636,  0.12  ,  3.45  ],
       [ 0.5904,  0.121 ,  3.66  ],
       [ 0.6199,  0.131 ,  3.88  ],
       [ 0.6526,  0.14  ,  4.15  ],
       [ 0.6888,  0.14  ,  4.44  ],
       [ 0.7293,  0.148 ,  4.74  ],
       [ 0.7749,  0.143 ,  5.09  ],
       [ 0.8266,  0.145 ,  5.5   ],
       [ 0.8856,  0.163 ,  5.95  ],
       [ 0.9537,  0.198 ,  6.43  ],
       [ 1.033 ,  0.226 ,  6.99  ],
       [ 1.127 ,  0.251 ,  7.67  ],
       [ 1.265 ,  0.375 ,  7.78  ],
       [ 1.291 ,  0.383 ,  7.92  ],
       [ 1.319 ,  0.392 ,  8.06  ],
       [ 1.348 ,  0.401 ,  8.21  ],
       [ 1.378 ,  0.411 ,  8.37  ],
       [ 1.409 ,  0.421 ,  8.37  ],
       [ 1.442 ,  0.431 ,  8.7   ],
       [ 1.476 ,  0.442 ,  8.88  ],
       [ 1.512 ,  0.455 ,  9.08  ],
       [ 1.55  ,  0.469 ,  9.32  ],
       [ 1.59  ,  0.485 ,  9.57  ],
       [ 1.631 ,  0.501 ,  9.84  ],
       [ 1.675 ,  0.519 , 10.1   ],
       [ 1.722 ,  0.537 , 10.4   ],
       [ 1.771 ,  0.557 , 10.7   ],
       [ 1.823 ,  0.578 , 11.1   ],
       [ 1.879 ,  0.6   , 11.4   ],
       [ 1.937 ,  0.624 , 11.8   ],
       [ 2.    ,  0.65  , 12.2   ],
       [ 2.066 ,  0.668 , 12.6   ],
       [ 2.138 ,  0.729 , 13.    ],
       [ 2.214 ,  0.774 , 13.5   ],
       [ 2.296 ,  0.823 , 14.    ],
       [ 2.384 ,  0.878 , 14.5   ],
       [ 2.48  ,  0.939 , 15.1   ],
       [ 2.583 ,  1.007 , 15.7   ],
       [ 2.695 ,  1.083 , 16.4   ],
       [ 2.818 ,  1.168 , 17.1   ],
       [ 2.952 ,  1.265 , 17.9   ],
       [ 3.1   ,  1.387 , 18.8   ],
       [ 3.263 ,  1.536 , 19.8   ],
       [ 3.444 ,  1.71  , 20.9   ],
       [ 3.647 ,  1.915 , 22.1   ],
       [ 3.875 ,  2.16  , 23.5   ],
       [ 4.133 ,  2.446 , 25.1   ],
       [ 4.428 ,  2.786 , 26.9   ],
       [ 4.769 ,  3.202 , 29.    ],
       [ 5.166 ,  3.732 , 31.3   ],
       [ 5.636 ,  4.425 , 34.    ],
       [ 6.199 ,  5.355 , 37.    ],
       [ 6.526 ,  5.96  , 38.6   ],
       [ 6.888 ,  6.67  , 40.4   ],
       [ 7.293 ,  7.461 , 42.5   ],
       [ 7.749 ,  8.376 , 44.8   ],
       [ 8.266 ,  9.441 , 47.1   ],
       [ 8.856 , 10.69  , 49.4   ],
       [ 9.537 , 12.21  , 52.2   ],
       [ 9.919 , 13.11  , 53.7   ]])
    
    lam=A[:,0]
    kap=A[:,2]
    ref=A[:,1]
    if lambdaX<lam[0] or lambdaX>lam[-1]:
            y=0
    else:
        ind=where(lam>=lambdaX)[0]
        wave_R=lam[ind[0]]
        if ind[0]==1:
            n=ref[0]
            k=kap[0]
        else:
            wave_L=lam[ind[0]-1]
            n=(ref[ind[0]]-ref[ind[0]-1])/(wave_R-wave_L)*(lambdaX-wave_L)+ref[ind[0]-1];
            k=(kap[ind[0]]-kap[ind[0]-1])/(wave_R-wave_L)*(lambdaX-wave_L)+kap[ind[0]-1];
            
    return (n+ complex(0,1) *k)**2



def SiC(lambdaX):
    A = array([[6.000e+00, 2.404e+00, 6.210e-03],
       [6.100e+00, 2.404e+00, 1.460e-03],
       [6.200e+00, 2.404e+00, 1.920e-02],
       [6.250e+00, 2.372e+00, 1.920e-02],
       [6.300e+00, 2.372e+00, 9.530e-03],
       [6.400e+00, 2.372e+00, 1.020e-02],
       [6.500e+00, 2.372e+00, 2.590e-02],
       [6.600e+00, 2.372e+00, 2.100e-02],
       [6.667e+00, 2.328e+00, 2.100e-02],
       [6.700e+00, 2.328e+00, 3.200e-03],
       [6.800e+00, 2.328e+00, 1.620e-03],
       [6.900e+00, 2.328e+00, 3.070e-03],
       [7.000e+00, 2.328e+00, 5.570e-03],
       [7.100e+00, 2.328e+00, 7.910e-03],
       [7.143e+00, 2.267e+00, 7.910e-03],
       [7.200e+00, 2.267e+00, 8.590e-03],
       [7.300e+00, 2.267e+00, 8.710e-03],
       [7.400e+00, 2.267e+00, 1.060e-02],
       [7.500e+00, 2.267e+00, 1.430e-02],
       [7.600e+00, 2.267e+00, 1.690e-02],
       [7.692e+00, 2.178e+00, 1.690e-02],
       [7.700e+00, 2.178e+00, 1.590e-02],
       [7.800e+00, 2.178e+00, 1.240e-02],
       [7.900e+00, 2.178e+00, 9.430e-03],
       [8.000e+00, 2.178e+00, 8.280e-03],
       [8.200e+00, 2.178e+00, 7.960e-03],
       [8.333e+00, 2.034e+00, 7.960e-03],
       [8.400e+00, 2.034e+00, 8.960e-03],
       [8.600e+00, 2.034e+00, 1.030e-02],
       [8.800e+00, 2.034e+00, 1.110e-02],
       [9.000e+00, 2.034e+00, 1.150e-02],
       [9.091e+00, 1.768e+00, 1.150e-02],
       [9.200e+00, 1.768e+00, 1.160e-02],
       [9.259e+00, 1.684e+00, 1.160e-02],
       [9.400e+00, 1.684e+00, 1.140e-02],
       [9.434e+00, 1.581e+00, 1.140e-02],
       [9.600e+00, 1.581e+00, 1.150e-02],
       [9.615e+00, 1.453e+00, 1.150e-02],
       [9.800e+00, 1.286e+00, 1.400e-02],
       [1.000e+01, 1.051e+00, 3.400e-02],
       [1.010e+01, 8.880e-01, 4.500e-02],
       [1.020e+01, 6.630e-01, 6.700e-02],
       [1.031e+01, 2.740e-01, 1.800e-01],
       [1.042e+01, 8.720e-02, 6.300e-01],
       [1.053e+01, 6.630e-02, 9.500e-01],
       [1.064e+01, 5.930e-02, 1.210e+00],
       [1.075e+01, 5.690e-02, 1.450e+00],
       [1.087e+01, 5.690e-02, 1.690e+00],
       [1.099e+01, 5.870e-02, 1.930e+00],
       [1.111e+01, 6.210e-02, 2.180e+00],
       [1.124e+01, 6.720e-02, 2.450e+00],
       [1.136e+01, 7.460e-02, 2.750e+00],
       [1.149e+01, 8.500e-02, 3.080e+00],
       [1.163e+01, 9.990e-02, 3.470e+00],
       [1.176e+01, 1.220e-01, 3.930e+00],
       [1.190e+01, 1.560e-01, 4.510e+00],
       [1.205e+01, 2.150e-01, 5.270e+00],
       [1.212e+01, 2.620e-01, 5.770e+00],
       [1.220e+01, 3.320e-01, 6.380e+00],
       [1.227e+01, 4.430e-01, 7.180e+00],
       [1.235e+01, 6.390e-01, 8.270e+00],
       [1.242e+01, 1.050e+00, 9.930e+00],
       [1.250e+01, 2.220e+00, 1.280e+01],
       [1.258e+01, 8.740e+00, 1.840e+01],
       [1.266e+01, 1.770e+01, 6.030e+00],
       [1.274e+01, 1.270e+01, 1.760e+00],
       [1.282e+01, 1.030e+01, 8.680e-01],
       [1.290e+01, 8.910e+00, 5.310e-01],
       [1.299e+01, 8.000e+00, 3.640e-01],
       [1.307e+01, 7.350e+00, 2.680e-01],
       [1.316e+01, 6.860e+00, 2.080e-01],
       [1.333e+01, 6.160e+00, 1.360e-01],
       [1.351e+01, 5.680e+00, 9.700e-02],
       [1.370e+01, 5.320e+00, 7.400e-02],
       [1.389e+01, 5.050e+00, 5.800e-02],
       [1.408e+01, 4.830e+00, 4.700e-02],
       [1.429e+01, 4.650e+00, 3.900e-02],
       [1.538e+01, 4.090e+00, 1.800e-02],
       [1.667e+01, 3.800e+00, 1.100e-02],
       [1.818e+01, 3.610e+00, 1.100e-02],
       [2.000e+01, 3.490e+00, 1.100e-02],
       [2.222e+01, 3.400e+00, 1.100e-02],
       [2.500e+01, 3.340e+00, 1.100e-02]])
    lam=A[:,0]
    kap=A[:,2]
    ref=A[:,1]
    if lambdaX<lam[0] or lambdaX>lam[-1]:
            y=0
    else:
        ind=where(lam>=lambdaX)[0]
        wave_R=lam[ind[0]]
        if ind[0]==1:
            n=ref[0]
            k=kap[0]
        else:
            wave_L=lam[ind[0]-1]
            n=(ref[ind[0]]-ref[ind[0]-1])/(wave_R-wave_L)*(lambdaX-wave_L)+ref[ind[0]-1];
            k=(kap[ind[0]]-kap[ind[0]-1])/(wave_R-wave_L)*(lambdaX-wave_L)+kap[ind[0]-1];
            
    return (n+ complex(0,1) *k)**2


def SiO2(lambdaX):
    A = array([[1.01200000e-01, 1.41000000e+00, 8.24000000e-01],
       [1.03300000e-01, 1.47500000e+00, 8.61000000e-01],
       [1.05100000e-01, 1.55400000e+00, 8.74000000e-01],
       [1.06900000e-01, 1.63500000e+00, 8.59000000e-01],
       [1.08800000e-01, 1.71600000e+00, 8.10000000e-01],
       [1.10700000e-01, 1.76600000e+00, 7.18000000e-01],
       [1.12700000e-01, 1.73900000e+00, 5.69000000e-01],
       [1.13700000e-01, 1.68700000e+00, 5.65000000e-01],
       [1.14800000e-01, 1.58700000e+00, 6.18000000e-01],
       [1.15900000e-01, 1.51300000e+00, 7.25000000e-01],
       [1.17000000e-01, 1.49200000e+00, 9.14000000e-01],
       [1.18100000e-01, 1.56700000e+00, 1.11000000e+00],
       [1.18700000e-01, 1.64500000e+00, 1.13600000e+00],
       [1.19200000e-01, 1.77200000e+00, 1.13200000e+00],
       [1.19800000e-01, 1.91900000e+00, 1.04500000e+00],
       [1.20400000e-01, 2.33000000e+00, 3.23000000e-01],
       [1.21000000e-01, 2.15200000e+00, 8.10000000e-01],
       [1.21500000e-01, 2.24000000e+00, 7.15000000e-01],
       [1.22800000e-01, 2.33200000e+00, 4.60000000e-01],
       [1.24000000e-01, 2.33000000e+00, 3.23000000e-01],
       [1.25200000e-01, 2.29200000e+00, 2.36000000e-01],
       [1.26500000e-01, 2.24300000e+00, 1.68000000e-01],
       [1.27800000e-01, 2.19000000e+00, 1.19000000e-01],
       [1.29100000e-01, 2.14000000e+00, 7.70000000e-02],
       [1.30500000e-01, 2.09200000e+00, 5.61000000e-02],
       [1.31900000e-01, 2.04700000e+00, 4.30000000e-02],
       [1.33300000e-01, 2.00600000e+00, 3.90000000e-02],
       [1.34800000e-01, 1.96900000e+00, 2.71000000e-02],
       [1.36200000e-01, 1.93500000e+00, 2.28000000e-02],
       [1.37800000e-01, 1.90400000e+00, 1.89000000e-02],
       [1.39300000e-01, 1.87600000e+00, 1.56000000e-02],
       [1.40900000e-01, 1.85000000e+00, 1.32000000e-02],
       [1.42500000e-01, 1.82500000e+00, 1.09000000e-02],
       [1.44200000e-01, 1.80300000e+00, 8.38000000e-03],
       [1.45900000e-01, 1.78300000e+00, 5.57000000e-03],
       [1.47600000e-01, 1.76400000e+00, 3.17000000e-03],
       [1.49400000e-01, 1.74700000e+00, 1.40000000e-03],
       [1.51200000e-01, 1.73000000e+00, 4.63000000e-04],
       [1.53100000e-01, 1.71600000e+00, 1.22000000e-04],
       [1.55000000e-01, 1.70200000e+00, 3.20000000e-05],
       [1.59000000e-01, 1.67000000e+00, 4.70000000e-06],
       [1.63100000e-01, 1.65300000e+00, 4.70000000e-06],
       [1.67500000e-01, 1.63300000e+00, 4.70000000e-06],
       [1.72200000e-01, 1.61600000e+00, 4.70000000e-06],
       [1.83700000e-01, 1.58200000e+00, 4.70000000e-06],
       [2.06600000e-01, 1.54300000e+00, 4.70000000e-06],
       [2.14438000e-01, 1.53371000e+00, 4.70000000e-06],
       [2.39938000e-01, 1.51338000e+00, 4.70000000e-06],
       [3.02000000e-01, 1.48179000e+00, 4.70000000e-06],
       [4.04656000e-01, 1.46961000e+00, 4.70000000e-06],
       [5.08582000e-01, 1.46187000e+00, 4.70000000e-06],
       [6.43847000e-01, 1.45671000e+00, 4.70000000e-06],
       [7.06519000e-01, 1.45515000e+00, 4.70000000e-06],
       [8.52111000e-01, 1.45280000e+00, 4.70000000e-06],
       [1.01398000e+00, 1.45025000e+00, 4.70000000e-06],
       [1.01398000e+00, 1.45025000e+00, 4.70000000e-06],
       [1.12866000e+00, 1.44888000e+00, 4.70000000e-06],
       [1.36220000e+00, 1.44621000e+00, 4.70000000e-06],
       [1.46950000e+00, 1.44497000e+00, 4.70000000e-06],
       [1.66060000e+00, 1.44226700e+00, 4.70000000e-06],
       [1.70913000e+00, 1.44205000e+00, 4.70000000e-06],
       [1.81307000e+00, 1.44069000e+00, 4.70000000e-06],
       [1.97000000e+00, 1.43451000e+00, 4.70000000e-06],
       [2.05610000e+00, 1.43272200e+00, 4.70000000e-06],
       [2.15260000e+00, 1.43567000e+00, 4.70000000e-06],
       [2.32452000e+00, 1.43292000e+00, 4.70000000e-06],
       [2.43740000e+00, 1.43095000e+00, 4.70000000e-06],
       [3.24390000e+00, 1.41340000e+00, 4.70000000e-06],
       [3.26680000e+00, 1.41253000e+00, 4.70000000e-06],
       [3.30260000e+00, 1.41155000e+00, 4.70000000e-06],
       [3.42200000e+00, 1.40819000e+00, 4.70000000e-06],
       [3.50700000e+00, 1.40568000e+00, 4.70000000e-06],
       [3.55640000e+00, 1.40418000e+00, 4.70000000e-06],
       [3.63600000e+00, 1.40162729e+00, 2.25000000e-05],
       [3.70400000e+00, 1.40195344e+00, 3.39000000e-05],
       [3.70670000e+00, 1.39936000e+00, 3.66000000e-05],
       [3.77400000e+00, 1.39209000e+00, 3.93000000e-05],
       [3.84600000e+00, 1.39500000e+00, 4.96000000e-05],
       [3.92200000e+00, 1.39200000e+00, 5.18000000e-05],
       [4.00000000e+00, 1.38900000e+00, 5.79000000e-05],
       [4.08200000e+00, 1.38600000e+00, 7.99000000e-05],
       [4.16700000e+00, 1.38300000e+00, 1.07000000e-04],
       [4.25500000e+00, 1.37880952e+00, 1.32000000e-04],
       [4.34800000e+00, 1.37438095e+00, 2.13000000e-04],
       [4.39600000e+00, 1.37209524e+00, 2.65000000e-04],
       [4.44400000e+00, 1.36980952e+00, 2.84000000e-04],
       [4.49400000e+00, 1.36742857e+00, 2.84000000e-04],
       [4.54500000e+00, 1.36500000e+00, 2.56000000e-04],
       [4.65100000e+00, 1.35964176e+00, 2.62000000e-04],
       [4.76200000e+00, 1.35403077e+00, 4.85000000e-04],
       [4.87800000e+00, 1.34816703e+00, 1.82000000e-03],
       [5.00000000e+00, 1.34200000e+00, 3.98000000e-03],
       [5.06300000e+00, 1.33792086e+00, 5.12000000e-03],
       [5.12800000e+00, 1.33371223e+00, 5.18000000e-03],
       [5.26300000e+00, 1.32497122e+00, 5.49000000e-03],
       [5.33300000e+00, 1.32043885e+00, 5.69000000e-03],
       [5.40500000e+00, 1.31577698e+00, 5.72000000e-03],
       [5.55600000e+00, 1.30600000e+00, 5.63000000e-03],
       [5.71400000e+00, 1.29242945e+00, 5.78000000e-03],
       [5.88200000e+00, 1.27800000e+00, 5.94000000e-03],
       [6.06100000e+00, 1.25902989e+00, 6.32000000e-03],
       [6.15400000e+00, 1.24917391e+00, 6.46000000e-03],
       [6.25000000e+00, 1.23900000e+00, 6.52000000e-03],
       [6.45200000e+00, 1.21200000e+00, 6.57000000e-03],
       [6.66700000e+00, 1.17500000e+00, 7.16000000e-03],
       [6.75700000e+00, 1.15800000e+00, 7.61000000e-03],
       [6.84900000e+00, 1.13500000e+00, 8.06000000e-03],
       [6.89700000e+00, 1.12100000e+00, 8.51000000e-03],
       [6.94400000e+00, 1.10700000e+00, 8.91000000e-03],
       [7.04200000e+00, 1.08400000e+00, 9.74000000e-03],
       [7.14300000e+00, 1.05300000e+00, 1.06000000e-02],
       [7.40700000e+00, 9.48800000e-01, 1.48000000e-02],
       [7.69200000e+00, 7.71900000e-01, 3.72000000e-02],
       [7.75200000e+00, 7.03700000e-01, 4.74000000e-02],
       [7.81300000e+00, 6.23200000e-01, 7.68000000e-02],
       [7.87400000e+00, 5.45600000e-01, 1.32000000e-01],
       [7.93700000e+00, 4.67700000e-01, 2.16000000e-01],
       [8.00000000e+00, 4.11300000e-01, 3.23000000e-01],
       [8.06500000e+00, 3.93100000e-01, 4.46000000e-01],
       [8.13000000e+00, 4.02000000e-01, 5.53000000e-01],
       [8.19700000e+00, 4.32900000e-01, 6.35000000e-01],
       [8.26500000e+00, 4.53000000e-01, 7.04000000e-01],
       [8.33300000e+00, 4.60000000e-01, 7.71000000e-01],
       [8.40300000e+00, 4.73000000e-01, 8.40000000e-01],
       [8.45000000e+00, 4.74600000e-01, 9.03000000e-01],
       [8.54700000e+00, 4.65600000e-01, 9.78000000e-01],
       [8.62100000e+00, 4.56300000e-01, 1.07000000e+00],
       [8.69600000e+00, 4.30300000e-01, 1.17000000e+00],
       [8.77200000e+00, 3.91500000e-01, 1.32000000e+00],
       [8.85000000e+00, 3.56300000e-01, 1.53000000e+00],
       [8.92900000e+00, 3.70500000e-01, 1.85000000e+00],
       [9.00900000e+00, 5.84600000e-01, 2.27000000e+00],
       [9.09100000e+00, 1.04300000e+00, 2.55000000e+00],
       [9.17400000e+00, 1.61600000e+00, 2.63000000e+00],
       [9.30200000e+00, 2.25000000e+00, 2.26000000e+00],
       [9.52400000e+00, 2.76000000e+00, 1.65000000e+00],
       [9.75000000e+00, 2.83900000e+00, 9.62000000e-01],
       [1.00000000e+01, 2.69400000e+00, 5.09000000e-01],
       [1.02600000e+01, 2.44800000e+00, 2.31000000e-01],
       [1.05300000e+01, 2.22400000e+00, 1.02000000e-01],
       [1.08100000e+01, 2.03800000e+00, 4.60000000e-02],
       [1.11100000e+01, 1.86900000e+00, 5.06000000e-02],
       [1.13600000e+01, 1.78400000e+00, 7.75000000e-02],
       [1.16300000e+01, 1.69000000e+00, 1.16000000e-01],
       [1.17600000e+01, 1.65200000e+00, 1.52000000e-01],
       [1.19000000e+01, 1.61900000e+00, 2.04000000e-01],
       [1.20500000e+01, 1.61500000e+00, 2.67000000e-01],
       [1.22000000e+01, 1.65800000e+00, 3.23000000e-01],
       [1.23500000e+01, 1.70100000e+00, 3.41000000e-01],
       [1.25000000e+01, 1.75300000e+00, 3.43000000e-01],
       [1.26600000e+01, 1.78900000e+00, 3.14000000e-01],
       [1.28200000e+01, 1.81100000e+00, 2.75000000e-01],
       [1.29900000e+01, 1.81000000e+00, 2.27000000e-01],
       [1.31600000e+01, 1.77900000e+00, 1.92000000e-01],
       [1.33300000e+01, 1.75600000e+00, 1.77000000e-01],
       [1.37900000e+01, 1.69800000e+00, 1.57000000e-01],
       [1.42900000e+01, 1.64300000e+00, 1.57000000e-01],
       [1.48100000e+01, 1.59800000e+00, 1.68000000e-01],
       [1.53800000e+01, 1.55500000e+00, 1.82000000e-01],
       [1.60000000e+01, 1.50200000e+00, 2.02000000e-01],
       [1.66700000e+01, 1.45000000e+00, 2.35000000e-01],
       [1.72400000e+01, 1.40100000e+00, 2.64000000e-01],
       [1.78600000e+01, 1.33700000e+00, 2.98000000e-01],
       [1.85200000e+01, 1.23500000e+00, 3.41000000e-01],
       [1.89700000e+01, 1.16100000e+00, 3.77000000e-01],
       [1.92300000e+01, 1.05000000e+00, 4.15000000e-01],
       [1.96100000e+01, 8.85700000e-01, 5.24000000e-01],
       [2.00000000e+01, 6.61600000e-01, 8.22000000e-01],
       [2.04100000e+01, 5.77700000e-01, 1.28000000e+00],
       [2.08300000e+01, 7.51700000e-01, 1.86000000e+00],
       [2.10500000e+01, 1.00200000e+00, 2.22000000e+00],
       [2.12800000e+01, 1.48400000e+00, 2.39000000e+00],
       [2.17400000e+01, 2.30800000e+00, 2.29000000e+00],
       [2.27300000e+01, 2.93000000e+00, 1.29000000e+00],
       [2.38100000e+01, 2.91200000e+00, 7.38000000e-01],
       [2.50000000e+01, 2.73900000e+00, 3.97000000e-01],
       [2.66700000e+01, 2.53700000e+00, 1.99000000e-01],
       [2.85700000e+01, 2.38800000e+00, 1.30000000e-01],
       [3.07700000e+01, 2.28400000e+00, 9.20000000e-02],
       [3.33300000e+01, 2.21000000e+00, 6.70000000e-02],
       [3.63600000e+01, 2.14700000e+00, 5.60000000e-02],
       [4.00000000e+01, 2.10000000e+00, 4.60000000e-02],
       [4.50000000e+01, 2.00000000e+00, 2.50000000e-02],
       [5.00000000e+01, 1.98000000e+00, 2.30000000e-02],
       [5.50000000e+01, 1.98000000e+00, 2.00000000e-02],
       [6.00000000e+01, 1.98000000e+00, 1.90000000e-02],
       [6.50000000e+01, 1.98000000e+00, 1.90000000e-02],
       [7.00000000e+01, 1.98000000e+00, 1.80000000e-02],
       [7.50000000e+01, 1.97000000e+00, 1.75000000e-02],
       [8.00000000e+01, 1.97000000e+00, 1.65000000e-02],
       [8.50000000e+01, 1.97000000e+00, 1.65000000e-02],
       [9.00000000e+01, 1.97000000e+00, 1.60000000e-02],
       [9.50000000e+01, 1.97000000e+00, 1.60000000e-02],
       [1.00000000e+02, 1.96700000e+00, 1.59000000e-02]])
    
    lam=A[:,0]
    kap=A[:,2]
    ref=A[:,1]
    if lambdaX<lam[0] or lambdaX>lam[-1]:
            y=0
    else:
        ind=where(lam>=lambdaX)[0]
        wave_R=lam[ind[0]]
        if ind[0]==1:
            n=ref[0]
            k=kap[0]
        else:
            wave_L=lam[ind[0]-1]
            n=(ref[ind[0]]-ref[ind[0]-1])/(wave_R-wave_L)*(lambdaX-wave_L)+ref[ind[0]-1];
            k=(kap[ind[0]]-kap[ind[0]-1])/(wave_R-wave_L)*(lambdaX-wave_L)+kap[ind[0]-1];
            
    return (n+ complex(0,1) *k)**2

def Au(lambdaX):
    A = array([[ 0.2       ,  1.427     ,  1.125     ],
       [ 0.2066    ,  1.422     ,  1.306     ],
       [ 0.2101    ,  1.43      ,  1.334     ],
       [ 0.2138    ,  1.432     ,  1.364     ],
       [ 0.2175    ,  1.438     ,  1.388     ],
       [ 0.2214    ,  1.442     ,  1.418     ],
       [ 0.2254    ,  1.452     ,  1.442     ],
       [ 0.2296    ,  1.454     ,  1.478     ],
       [ 0.2339    ,  1.462     ,  1.51      ],
       [ 0.2384    ,  1.47      ,  1.55      ],
       [ 0.2431    ,  1.478     ,  1.59      ],
       [ 0.248     ,  1.484     ,  1.636     ],
       [ 0.253     ,  1.49      ,  1.698     ],
       [ 0.2583    ,  1.504     ,  1.748     ],
       [ 0.2638    ,  1.546     ,  1.784     ],
       [ 0.2695    ,  1.598     ,  1.822     ],
       [ 0.2755    ,  1.648     ,  1.852     ],
       [ 0.2818    ,  1.69      ,  1.882     ],
       [ 0.2883    ,  1.742     ,  1.9       ],
       [ 0.2952    ,  1.776     ,  1.918     ],
       [ 0.3024    ,  1.812     ,  1.92      ],
       [ 0.31      ,  1.83      ,  1.916     ],
       [ 0.3179    ,  1.84      ,  1.904     ],
       [ 0.3263    ,  1.824     ,  1.878     ],
       [ 0.3351    ,  1.798     ,  1.86      ],
       [ 0.3444    ,  1.766     ,  1.846     ],
       [ 0.3542    ,  1.74      ,  1.848     ],
       [ 0.3647    ,  1.716     ,  1.862     ],
       [ 0.3757    ,  1.696     ,  1.906     ],
       [ 0.3875    ,  1.674     ,  1.936     ],
       [ 0.4       ,  1.658     ,  1.956     ],
       [ 0.4133    ,  1.636     ,  1.958     ],
       [ 0.4275    ,  1.616     ,  1.94      ],
       [ 0.4428    ,  1.562     ,  1.904     ],
       [ 0.4592    ,  1.426     ,  1.846     ],
       [ 0.4769    ,  1.242     ,  1.796     ],
       [ 0.4959    ,  0.916     ,  1.84      ],
       [ 0.5166    ,  0.608     ,  2.12      ],
       [ 0.5391    ,  0.402     ,  2.54      ],
       [ 0.5636    ,  0.306     ,  2.88      ],
       [ 0.5904    ,  0.236     ,  2.96130337],
       [ 0.6199    ,  0.194     ,  3.05079775],
       [ 0.6526    ,  0.166     ,  3.15      ],
       [ 0.6888    ,  0.16      ,  3.8       ],
       [ 0.7293    ,  0.164     ,  4.35      ],
       [ 0.7749    ,  0.174     ,  4.86      ],
       [ 0.8266    ,  0.188     ,  5.39      ],
       [ 0.8856    ,  0.21      ,  5.88      ],
       [ 0.9537    ,  0.236     ,  6.47      ],
       [ 1.033     ,  0.272     ,  7.07      ],
       [ 1.265     ,  0.389     ,  8.09      ],
       [ 1.291     ,  0.403     ,  8.25      ],
       [ 1.319     ,  0.419     ,  8.42      ],
       [ 1.348     ,  0.436     ,  8.59      ],
       [ 1.378     ,  0.454     ,  8.77      ],
       [ 1.409     ,  0.473     ,  8.96      ],
       [ 1.442     ,  0.493     ,  9.15      ],
       [ 1.476     ,  0.515     ,  9.36      ],
       [ 1.512     ,  0.537     ,  9.58      ],
       [ 1.55      ,  0.559     ,  9.81      ],
       [ 1.59      ,  0.583     , 10.1       ],
       [ 1.631     ,  0.609     , 10.3       ],
       [ 1.675     ,  0.636     , 10.6       ],
       [ 1.722     ,  0.665     , 10.9       ],
       [ 1.771     ,  0.696     , 11.2       ],
       [ 1.823     ,  0.73      , 11.5       ],
       [ 1.879     ,  0.767     , 11.9       ],
       [ 1.937     ,  0.807     , 12.2       ],
       [ 2.        ,  0.85      , 12.6       ],
       [ 2.066     ,  0.896     , 13.        ],
       [ 2.138     ,  0.947     , 13.4       ],
       [ 2.214     ,  1.002     , 13.9       ],
       [ 2.296     ,  1.063     , 14.4       ],
       [ 2.384     ,  1.13      , 14.9       ],
       [ 2.48      ,  1.205     , 15.5       ],
       [ 2.583     ,  1.287     , 16.1       ],
       [ 2.695     ,  1.379     , 16.8       ],
       [ 2.818     ,  1.482     , 17.5       ],
       [ 2.952     ,  1.598     , 18.3       ],
       [ 3.1       ,  1.728     , 19.2       ],
       [ 3.179     ,  1.8       , 19.7       ],
       [ 3.263     ,  1.876     , 20.2       ],
       [ 3.351     ,  1.958     , 20.7       ],
       [ 3.444     ,  2.046     , 21.3       ],
       [ 3.542     ,  2.141     , 21.9       ],
       [ 3.647     ,  2.242     , 22.5       ],
       [ 3.757     ,  2.352     , 23.1       ],
       [ 3.875     ,  2.471     , 23.9       ],
       [ 4.        ,  2.6       , 24.6       ],
       [ 4.133     ,  2.749     , 25.4       ],
       [ 4.275     ,  2.912     , 26.3       ],
       [ 4.428     ,  3.091     , 27.2       ],
       [ 4.592     ,  3.289     , 28.2       ],
       [ 4.769     ,  3.507     , 29.3       ],
       [ 4.959     ,  3.748     , 30.5       ],
       [ 5.166     ,  4.007     , 31.7       ],
       [ 5.391     ,  4.292     , 32.9       ],
       [ 5.636     ,  4.611     , 34.3       ],
       [ 5.904     ,  4.971     , 35.9       ],
       [ 6.199     ,  5.423     , 37.5       ],
       [ 6.358     ,  5.684     , 38.3       ],
       [ 6.526     ,  5.966     , 39.1       ],
       [ 6.702     ,  6.27      , 40.1       ],
       [ 6.888     ,  6.598     , 41.        ],
       [ 7.085     ,  6.937     , 42.        ],
       [ 7.293     ,  7.282     , 43.        ],
       [ 7.514     ,  7.655     , 44.1       ],
       [ 7.749     ,  8.06      , 45.2       ],
       [ 7.999     ,  8.5       , 46.4       ],
       [ 8.266     ,  9.016     , 47.6       ],
       [ 8.551     ,  9.582     , 48.8       ],
       [ 8.856     , 10.21      , 50.2       ],
       [ 9.184     , 10.84      , 51.6       ],
       [ 9.537     , 11.51      , 53.1       ],
       [ 9.919     , 12.24      , 54.7       ]])
    
    lam=A[:,0]
    kap=A[:,2]
    ref=A[:,1]
    if lambdaX<lam[0] or lambdaX>lam[-1]:
            y=0
    else:
        ind=where(lam>=lambdaX)[0]
        wave_R=lam[ind[0]]
        if ind[0]==1:
            n=ref[0]
            k=kap[0]
        else:
            wave_L=lam[ind[0]-1]
            n=(ref[ind[0]]-ref[ind[0]-1])/(wave_R-wave_L)*(lambdaX-wave_L)+ref[ind[0]-1];
            k=(kap[ind[0]]-kap[ind[0]-1])/(wave_R-wave_L)*(lambdaX-wave_L)+kap[ind[0]-1];
            
    return (n+ complex(0,1) *k)**2



def We(lambdaX):
    A = array([[ 0.2       ,  1.47      ,  3.24      ],
       [ 0.2033    ,  1.58      ,  3.33      ],
       [ 0.2066    ,  1.7       ,  3.42      ],
       [ 0.2101    ,  1.83      ,  3.52      ],
       [ 0.2138    ,  2.        ,  3.61      ],
       [ 0.2175    ,  2.2       ,  3.67      ],
       [ 0.2214    ,  2.43      ,  3.7       ],
       [ 0.2254    ,  2.68      ,  3.68      ],
       [ 0.2296    ,  2.92      ,  3.58      ],
       [ 0.2339    ,  3.11      ,  3.43      ],
       [ 0.2384    ,  3.27      ,  3.27      ],
       [ 0.2431    ,  3.38      ,  3.05      ],
       [ 0.248     ,  3.4       ,  2.85      ],
       [ 0.253     ,  3.37      ,  2.68      ],
       [ 0.2583    ,  3.33      ,  2.57      ],
       [ 0.2638    ,  3.29      ,  2.48      ],
       [ 0.2695    ,  3.24      ,  2.41      ],
       [ 0.2755    ,  3.19      ,  2.35      ],
       [ 0.2818    ,  3.13      ,  2.32      ],
       [ 0.2883    ,  3.07      ,  2.31      ],
       [ 0.2952    ,  3.01      ,  2.33      ],
       [ 0.3024    ,  2.97      ,  2.37      ],
       [ 0.31      ,  2.95      ,  2.43      ],
       [ 0.3139    ,  2.95      ,  2.46      ],
       [ 0.3179    ,  2.96      ,  2.5       ],
       [ 0.322     ,  2.98      ,  2.53      ],
       [ 0.3263    ,  2.99      ,  2.56      ],
       [ 0.3306    ,  3.02      ,  2.6       ],
       [ 0.3351    ,  3.05      ,  2.62      ],
       [ 0.3397    ,  3.09      ,  2.65      ],
       [ 0.3444    ,  3.13      ,  2.67      ],
       [ 0.3493    ,  3.18      ,  2.69      ],
       [ 0.3542    ,  3.24      ,  2.7       ],
       [ 0.3594    ,  3.32      ,  2.7       ],
       [ 0.3701    ,  3.43      ,  2.6       ],
       [ 0.3757    ,  3.45      ,  2.55      ],
       [ 0.3815    ,  3.45      ,  2.49      ],
       [ 0.3875    ,  3.43      ,  2.45      ],
       [ 0.3936    ,  3.41      ,  2.43      ],
       [ 0.4       ,  3.39      ,  2.41      ],
       [ 0.4065    ,  3.37      ,  2.42      ],
       [ 0.4133    ,  3.35      ,  2.42      ],
       [ 0.4203    ,  3.33      ,  2.43      ],
       [ 0.4275    ,  3.32      ,  2.45      ],
       [ 0.435     ,  3.31      ,  2.47      ],
       [ 0.4428    ,  3.3       ,  2.49      ],
       [ 0.4509    ,  3.31      ,  2.53      ],
       [ 0.4592    ,  3.31      ,  2.55      ],
       [ 0.4679    ,  3.32      ,  2.59      ],
       [ 0.4769    ,  3.34      ,  2.62      ],
       [ 0.4862    ,  3.35      ,  2.64      ],
       [ 0.4959    ,  3.38      ,  2.68      ],
       [ 0.5061    ,  3.42      ,  2.71      ],
       [ 0.5166    ,  3.45      ,  2.72      ],
       [ 0.5276    ,  3.48      ,  2.72      ],
       [ 0.5391    ,  3.5       ,  2.72      ],
       [ 0.551     ,  3.5       ,  2.73      ],
       [ 0.5636    ,  3.49      ,  2.75      ],
       [ 0.5767    ,  3.51      ,  2.81      ],
       [ 0.5904    ,  3.54      ,  2.84      ],
       [ 0.6048    ,  3.57      ,  2.86      ],
       [ 0.6199    ,  3.6       ,  2.89      ],
       [ 0.6358    ,  3.65      ,  2.92      ],
       [ 0.6526    ,  3.7       ,  2.94      ],
       [ 0.6702    ,  3.76      ,  2.95      ],
       [ 0.6888    ,  3.82      ,  2.91      ],
       [ 0.7085    ,  3.85      ,  2.86      ],
       [ 0.7293    ,  3.84      ,  2.78      ],
       [ 0.74035   ,  3.81      ,  2.75      ],
       [ 0.7514    ,  3.78      ,  2.72      ],
       [ 0.7749    ,  3.67      ,  2.68      ],
       [ 0.7999    ,  3.56      ,  2.73      ],
       [ 0.81325   ,  3.52      ,  2.76      ],
       [ 0.8266    ,  3.48      ,  2.79      ],
       [ 0.84085   ,  3.43      ,  2.82      ],
       [ 0.8551    ,  3.38      ,  2.85      ],
       [ 0.87035   ,  3.335     ,  2.905     ],
       [ 0.8856    ,  3.29      ,  2.96      ],
       [ 0.902     ,  3.245     ,  3.015     ],
       [ 0.9184    ,  3.2       ,  3.07      ],
       [ 0.93605   ,  3.16      ,  3.155     ],
       [ 0.9537    ,  3.12      ,  3.24      ],
       [ 0.9728    ,  3.085     ,  3.315     ],
       [ 0.9919    ,  3.05      ,  3.39      ],
       [ 1.01245   ,  3.025     ,  3.515     ],
       [ 1.033     ,  3.        ,  3.64      ],
       [ 1.0555    ,  3.01      ,  3.735     ],
       [ 1.078     ,  3.02      ,  3.83      ],
       [ 1.09025   ,  3.0275    ,  3.8825    ],
       [ 1.1025    ,  3.035     ,  3.935     ],
       [ 1.127     ,  3.05      ,  4.04      ],
       [ 1.1405    ,  3.065     ,  4.0775    ],
       [ 1.154     ,  3.08      ,  4.115     ],
       [ 1.1675    ,  3.095     ,  4.1525    ],
       [ 1.181     ,  3.11      ,  4.19      ],
       [ 1.19575   ,  3.1175    ,  4.2225    ],
       [ 1.2105    ,  3.125     ,  4.255     ],
       [ 1.22525   ,  3.1325    ,  4.2875    ],
       [ 1.24      ,  3.14      ,  4.32      ],
       [ 1.265     ,  3.15      ,  4.36      ],
       [ 1.278     ,  3.15      ,  4.385     ],
       [ 1.291     ,  3.15      ,  4.41      ],
       [ 1.319     ,  3.15      ,  4.43      ],
       [ 1.3335    ,  3.145     ,  4.44      ],
       [ 1.348     ,  3.14      ,  4.45      ],
       [ 1.363     ,  3.125     ,  4.445     ],
       [ 1.378     ,  3.11      ,  4.44      ],
       [ 1.3935    ,  3.08      ,  4.43      ],
       [ 1.409     ,  3.05      ,  4.42      ],
       [ 1.425     ,  3.        ,  4.39      ],
       [ 1.442     ,  2.92      ,  4.37      ],
       [ 1.459     ,  2.8       ,  4.33      ],
       [ 1.476     ,  2.62      ,  4.37      ],
       [ 1.494     ,  2.47      ,  4.47      ],
       [ 1.512     ,  2.36      ,  4.61      ],
       [ 1.531     ,  2.29      ,  4.73      ],
       [ 1.55      ,  2.22      ,  4.85      ],
       [ 1.57      ,  2.17      ,  4.95      ],
       [ 1.59      ,  2.12      ,  5.05      ],
       [ 1.61      ,  2.03      ,  5.16      ],
       [ 1.63      ,  1.94      ,  5.27      ],
       [ 1.6525    ,  1.885     ,  5.395     ],
       [ 1.675     ,  1.83      ,  5.52      ],
       [ 1.6985    ,  1.765     ,  5.665     ],
       [ 1.722     ,  1.7       ,  5.81      ],
       [ 1.7465    ,  1.645     ,  5.97      ],
       [ 1.75875   ,  1.6175    ,  6.05      ],
       [ 1.771     ,  1.59      ,  6.13      ],
       [ 1.797     ,  1.555     ,  6.29      ],
       [ 1.81      ,  1.5375    ,  6.37      ],
       [ 1.823     ,  1.52      ,  6.45      ],
       [ 1.837     ,  1.5025    ,  6.5325    ],
       [ 1.851     ,  1.485     ,  6.615     ],
       [ 1.879     ,  1.45      ,  6.78      ],
       [ 1.8935    ,  1.4275    ,  6.87      ],
       [ 1.908     ,  1.405     ,  6.96      ],
       [ 1.9225    ,  1.3825    ,  7.05      ],
       [ 1.937     ,  1.36      ,  7.14      ],
       [ 1.95275   ,  1.34      ,  7.235     ],
       [ 1.9685    ,  1.32      ,  7.33      ],
       [ 1.98425   ,  1.3       ,  7.425     ],
       [ 2.        ,  1.28      ,  7.52      ],
       [ 2.0165    ,  1.2625    ,  7.63      ],
       [ 2.033     ,  1.245     ,  7.74      ],
       [ 2.0495    ,  1.2275    ,  7.85      ],
       [ 2.066     ,  1.21      ,  7.96      ],
       [ 2.084     ,  1.2025    ,  8.08      ],
       [ 2.102     ,  1.195     ,  8.2       ],
       [ 2.12      ,  1.1875    ,  8.32      ],
       [ 2.138     ,  1.18      ,  8.44      ],
       [ 2.157     ,  1.185     ,  8.565     ],
       [ 2.176     ,  1.19      ,  8.69      ],
       [ 2.195     ,  1.195     ,  8.815     ],
       [ 2.214     ,  1.2       ,  8.94      ],
       [ 2.2345    ,  1.2075    ,  9.0675    ],
       [ 2.255     ,  1.215     ,  9.195     ],
       [ 2.2755    ,  1.2225    ,  9.3225    ],
       [ 2.296     ,  1.23      ,  9.45      ],
       [ 2.318     ,  1.2475    ,  9.5825    ],
       [ 2.329     ,  1.25625   ,  9.64875   ],
       [ 2.34      ,  1.265     ,  9.715     ],
       [ 2.362     ,  1.2825    ,  9.8475    ],
       [ 2.384     ,  1.3       ,  9.98      ],
       [ 2.408     ,  1.325     , 10.11      ],
       [ 2.42      ,  1.3375    , 10.175     ],
       [ 2.432     ,  1.35      , 10.24      ],
       [ 2.456     ,  1.375     , 10.37      ],
       [ 2.468     ,  1.3875    , 10.435     ],
       [ 2.48      ,  1.4       , 10.5       ],
       [ 2.50575   ,  1.435     , 10.65      ],
       [ 2.518625  ,  1.4525    , 10.725     ],
       [ 2.5315    ,  1.47      , 10.8       ],
       [ 2.55725   ,  1.505     , 10.95      ],
       [ 2.570125  ,  1.5225    , 11.025     ],
       [ 2.583     ,  1.54      , 11.1       ],
       [ 2.597     ,  1.55875   , 11.1625    ],
       [ 2.611     ,  1.5775    , 11.225     ],
       [ 2.639     ,  1.615     , 11.35      ],
       [ 2.653     ,  1.63375   , 11.4125    ],
       [ 2.667     ,  1.6525    , 11.475     ],
       [ 2.681     ,  1.67125   , 11.5375    ],
       [ 2.695     ,  1.69      , 11.6       ],
       [ 2.710375  ,  1.70625   , 11.6625    ],
       [ 2.72575   ,  1.7225    , 11.725     ],
       [ 2.741125  ,  1.73875   , 11.7875    ],
       [ 2.7565    ,  1.755     , 11.85      ],
       [ 2.771875  ,  1.77125   , 11.9125    ],
       [ 2.78725   ,  1.7875    , 11.975     ],
       [ 2.802625  ,  1.80375   , 12.0375    ],
       [ 2.818     ,  1.82      , 12.1       ],
       [ 2.83475   ,  1.8325    , 12.1625    ],
       [ 2.8515    ,  1.845     , 12.225     ],
       [ 2.86825   ,  1.8575    , 12.2875    ],
       [ 2.885     ,  1.87      , 12.35      ],
       [ 2.90175   ,  1.8825    , 12.4125    ],
       [ 2.9185    ,  1.895     , 12.475     ],
       [ 2.93525   ,  1.9075    , 12.5375    ],
       [ 2.952     ,  1.92      , 12.6       ],
       [ 2.9705    ,  1.9225    , 12.675     ],
       [ 2.989     ,  1.925     , 12.75      ],
       [ 3.0075    ,  1.9275    , 12.825     ],
       [ 3.026     ,  1.93      , 12.9       ],
       [ 3.0445    ,  1.9325    , 12.975     ],
       [ 3.063     ,  1.935     , 13.05      ],
       [ 3.0815    ,  1.9375    , 13.125     ],
       [ 3.1       ,  1.94      , 13.2       ],
       [ 3.120375  ,  1.93      , 13.2875    ],
       [ 3.14075   ,  1.92      , 13.375     ],
       [ 3.161125  ,  1.91      , 13.4625    ],
       [ 3.1815    ,  1.9       , 13.55      ],
       [ 3.201875  ,  1.89      , 13.6375    ],
       [ 3.22225   ,  1.88      , 13.725     ],
       [ 3.242625  ,  1.87      , 13.8125    ],
       [ 3.263     ,  1.86      , 13.9       ],
       [ 3.285625  ,  1.855     , 14.        ],
       [ 3.30825   ,  1.85      , 14.1       ],
       [ 3.3195625 ,  1.8475    , 14.15      ],
       [ 3.330875  ,  1.845     , 14.2       ],
       [ 3.3535    ,  1.84      , 14.3       ],
       [ 3.376125  ,  1.835     , 14.4       ],
       [ 3.39875   ,  1.83      , 14.5       ],
       [ 3.4100625 ,  1.8275    , 14.55      ],
       [ 3.42703125,  1.82375   , 14.625     ],
       [ 3.444     ,  1.82      , 14.7       ],
       [ 3.469375  ,  1.80625   , 14.825     ],
       [ 3.4820625 ,  1.799375  , 14.8875    ],
       [ 3.49475   ,  1.7925    , 14.95      ],
       [ 3.520125  ,  1.77875   , 15.075     ],
       [ 3.5455    ,  1.765     , 15.2       ],
       [ 3.5581875 ,  1.758125  , 15.2625    ],
       [ 3.570875  ,  1.75125   , 15.325     ],
       [ 3.59625   ,  1.7375    , 15.45      ],
       [ 3.6089375 ,  1.730625  , 15.5125    ],
       [ 3.621625  ,  1.72375   , 15.575     ],
       [ 3.647     ,  1.71      , 15.7       ],
       [ 3.66125   ,  1.710625  , 15.775     ],
       [ 3.6755    ,  1.71125   , 15.85      ],
       [ 3.682625  ,  1.7115625 , 15.8875    ],
       [ 3.704     ,  1.7125    , 16.        ],
       [ 3.71825   ,  1.713125  , 16.075     ],
       [ 3.7325    ,  1.71375   , 16.15      ],
       [ 3.74675   ,  1.714375  , 16.225     ],
       [ 3.761     ,  1.715     , 16.3       ],
       [ 3.7895    ,  1.71625   , 16.45      ],
       [ 3.80375   ,  1.716875  , 16.525     ],
       [ 3.818     ,  1.7175    , 16.6       ],
       [ 3.83225   ,  1.718125  , 16.675     ],
       [ 3.8465    ,  1.71875   , 16.75      ],
       [ 3.86075   ,  1.719375  , 16.825     ],
       [ 3.875     ,  1.72      , 16.9       ],
       [ 3.891125  ,  1.726875  , 16.9875    ],
       [ 3.90725   ,  1.73375   , 17.075     ],
       [ 3.923375  ,  1.740625  , 17.1625    ],
       [ 3.9395    ,  1.7475    , 17.25      ],
       [ 3.955625  ,  1.754375  , 17.3375    ],
       [ 3.97175   ,  1.76125   , 17.425     ],
       [ 3.987875  ,  1.768125  , 17.5125    ],
       [ 4.004     ,  1.775     , 17.6       ],
       [ 4.020125  ,  1.781875  , 17.6875    ],
       [ 4.03625   ,  1.78875   , 17.775     ],
       [ 4.052375  ,  1.795625  , 17.8625    ],
       [ 4.0685    ,  1.8025    , 17.95      ],
       [ 4.084625  ,  1.809375  , 18.0375    ],
       [ 4.1088125 ,  1.8196875 , 18.16875   ],
       [ 4.12090625,  1.82484375, 18.234375  ],
       [ 4.133     ,  1.83      , 18.3       ],
       [ 4.1426875 ,  1.8459375 , 18.340625  ],
       [ 4.1588125 ,  1.8528125 , 18.428125  ],
       [ 4.17171875,  1.86421875, 18.4921875 ],
       [ 4.184625  ,  1.875625  , 18.55625   ],
       [ 4.19753125,  1.88703125, 18.6203125 ],
       [ 4.2104375 ,  1.8984375 , 18.684375  ],
       [ 4.23625   ,  1.92125   , 18.8125    ],
       [ 4.24270313,  1.92695313, 18.84453125],
       [ 4.25883594,  1.94121094, 18.92460938],
       [ 4.27496875,  1.95546875, 19.0046875 ],
       [ 4.29110156,  1.96972656, 19.08476563],
       [ 4.30723438,  1.98398437, 19.16484375],
       [ 4.32336719,  1.99824219, 19.24492188],
       [ 4.3395    ,  2.0125    , 19.325     ],
       [ 4.35038965,  2.02212402, 19.37905273],
       [ 4.3612793 ,  2.03174805, 19.43310547],
       [ 4.38305859,  2.05099609, 19.54121094],
       [ 4.40483789,  2.07024414, 19.64931641],
       [ 4.42661719,  2.08949219, 19.75742188],
       [ 4.44154004,  2.10268066, 19.83149414],
       [ 4.45646289,  2.11586914, 19.90556641],
       [ 4.47138574,  2.12905762, 19.97963867],
       [ 4.48630859,  2.14224609, 20.05371094],
       [ 4.50123145,  2.15543457, 20.1277832 ],
       [ 4.5161543 ,  2.16862305, 20.20185547],
       [ 4.53107715,  2.18181152, 20.27592773],
       [ 4.546     ,  2.195     , 20.35      ],
       [ 4.55890625,  2.20640625, 20.4140625 ],
       [ 4.5718125 ,  2.2178125 , 20.478125  ],
       [ 4.597625  ,  2.240625  , 20.60625   ],
       [ 4.61053125,  2.25203125, 20.6703125 ],
       [ 4.6234375 ,  2.2634375 , 20.734375  ],
       [ 4.64925   ,  2.28625   , 20.8625    ],
       [ 4.66215625,  2.29765625, 20.9265625 ],
       [ 4.6750625 ,  2.3090625 , 20.990625  ],
       [ 4.68796875,  2.32046875, 21.0546875 ],
       [ 4.700875  ,  2.331875  , 21.11875   ],
       [ 4.7266875 ,  2.3546875 , 21.246875  ],
       [ 4.73959375,  2.36609375, 21.3109375 ],
       [ 4.7525    ,  2.3775    , 21.375     ],
       [ 4.7783125 ,  2.4003125 , 21.503125  ],
       [ 4.79121875,  2.41171875, 21.5671875 ],
       [ 4.804125  ,  2.423125  , 21.63125   ],
       [ 4.8299375 ,  2.4459375 , 21.759375  ],
       [ 4.84284375,  2.45734375, 21.8234375 ],
       [ 4.85575   ,  2.46875   , 21.8875    ],
       [ 4.86865625,  2.48015625, 21.9515625 ],
       [ 4.8815625 ,  2.4915625 , 22.015625  ],
       [ 4.907375  ,  2.514375  , 22.14375   ],
       [ 4.92028125,  2.52578125, 22.2078125 ],
       [ 4.9331875 ,  2.5371875 , 22.271875  ],
       [ 4.959     ,  2.56      , 22.4       ],
       [ 4.978375  ,  2.58046875, 22.4921875 ],
       [ 4.99775   ,  2.6009375 , 22.584375  ],
       [ 5.017125  ,  2.62140625, 22.6765625 ],
       [ 5.0365    ,  2.641875  , 22.76875   ],
       [ 5.055875  ,  2.66234375, 22.8609375 ],
       [ 5.07525   ,  2.6828125 , 22.953125  ],
       [ 5.094625  ,  2.70328125, 23.0453125 ],
       [ 5.114     ,  2.72375   , 23.1375    ],
       [ 5.133375  ,  2.74421875, 23.2296875 ],
       [ 5.15275   ,  2.7646875 , 23.321875  ],
       [ 5.172125  ,  2.78515625, 23.4140625 ],
       [ 5.1915    ,  2.805625  , 23.50625   ],
       [ 5.210875  ,  2.82609375, 23.5984375 ],
       [ 5.23025   ,  2.8465625 , 23.690625  ],
       [ 5.249625  ,  2.86703125, 23.7828125 ],
       [ 5.269     ,  2.8875    , 23.875     ],
       [ 5.288375  ,  2.90796875, 23.9671875 ],
       [ 5.30775   ,  2.9284375 , 24.059375  ],
       [ 5.327125  ,  2.94890625, 24.1515625 ],
       [ 5.3465    ,  2.969375  , 24.24375   ],
       [ 5.365875  ,  2.98984375, 24.3359375 ],
       [ 5.38525   ,  3.0103125 , 24.428125  ],
       [ 5.404625  ,  3.03078125, 24.5203125 ],
       [ 5.424     ,  3.05125   , 24.6125    ],
       [ 5.443375  ,  3.07171875, 24.7046875 ],
       [ 5.46275   ,  3.0921875 , 24.796875  ],
       [ 5.482125  ,  3.11265625, 24.8890625 ],
       [ 5.5015    ,  3.133125  , 24.98125   ],
       [ 5.520875  ,  3.15359375, 25.0734375 ],
       [ 5.54025   ,  3.1740625 , 25.165625  ],
       [ 5.559625  ,  3.19453125, 25.2578125 ],
       [ 5.579     ,  3.215     , 25.35      ],
       [ 5.598375  ,  3.23546875, 25.4421875 ],
       [ 5.61775   ,  3.2559375 , 25.534375  ],
       [ 5.637125  ,  3.27640625, 25.6265625 ],
       [ 5.6565    ,  3.296875  , 25.71875   ],
       [ 5.675875  ,  3.31734375, 25.8109375 ],
       [ 5.69525   ,  3.3378125 , 25.903125  ],
       [ 5.714625  ,  3.35828125, 25.9953125 ],
       [ 5.734     ,  3.37875   , 26.0875    ],
       [ 5.753375  ,  3.39921875, 26.1796875 ],
       [ 5.77275   ,  3.4196875 , 26.271875  ],
       [ 5.792125  ,  3.44015625, 26.3640625 ],
       [ 5.8115    ,  3.460625  , 26.45625   ],
       [ 5.830875  ,  3.48109375, 26.5484375 ],
       [ 5.84540625,  3.49644531, 26.61757813],
       [ 5.8599375 ,  3.51179687, 26.68671875],
       [ 5.87446875,  3.52714844, 26.75585938],
       [ 5.889     ,  3.5425    , 26.825     ],
       [ 5.908375  ,  3.56296875, 26.9171875 ],
       [ 5.92775   ,  3.5834375 , 27.009375  ],
       [ 5.947125  ,  3.60390625, 27.1015625 ],
       [ 5.9665    ,  3.624375  , 27.19375   ],
       [ 5.985875  ,  3.64484375, 27.2859375 ],
       [ 6.00525   ,  3.6653125 , 27.378125  ],
       [ 6.024625  ,  3.68578125, 27.4703125 ],
       [ 6.044     ,  3.70625   , 27.5625    ],
       [ 6.063375  ,  3.72671875, 27.6546875 ],
       [ 6.08275   ,  3.7471875 , 27.746875  ],
       [ 6.102125  ,  3.76765625, 27.8390625 ],
       [ 6.1215    ,  3.788125  , 27.93125   ],
       [ 6.140875  ,  3.80859375, 28.0234375 ],
       [ 6.16025   ,  3.8290625 , 28.115625  ],
       [ 6.179625  ,  3.84953125, 28.2078125 ],
       [ 6.199     ,  3.87      , 28.3       ],
       [ 6.20976563,  3.88328125, 28.35      ],
       [ 6.22053125,  3.8965625 , 28.4       ],
       [ 6.2420625 ,  3.923125  , 28.5       ],
       [ 6.26359375,  3.9496875 , 28.6       ],
       [ 6.285125  ,  3.97625   , 28.7       ],
       [ 6.30665625,  4.0028125 , 28.8       ],
       [ 6.3281875 ,  4.029375  , 28.9       ],
       [ 6.34971875,  4.0559375 , 29.        ],
       [ 6.36048438,  4.06921875, 29.05      ],
       [ 6.37125   ,  4.0825    , 29.1       ],
       [ 6.39278125,  4.1090625 , 29.2       ],
       [ 6.4143125 ,  4.135625  , 29.3       ],
       [ 6.43584375,  4.1621875 , 29.4       ],
       [ 6.457375  ,  4.18875   , 29.5       ],
       [ 6.47890625,  4.2153125 , 29.6       ],
       [ 6.48967187,  4.22859375, 29.65      ],
       [ 6.5004375 ,  4.241875  , 29.7       ],
       [ 6.52196875,  4.2684375 , 29.8       ],
       [ 6.5435    ,  4.295     , 29.9       ],
       [ 6.56503125,  4.3215625 , 30.        ],
       [ 6.5865625 ,  4.348125  , 30.1       ],
       [ 6.60809375,  4.3746875 , 30.2       ],
       [ 6.629625  ,  4.40125   , 30.3       ],
       [ 6.64039063,  4.41453125, 30.35      ],
       [ 6.65115625,  4.4278125 , 30.4       ],
       [ 6.6726875 ,  4.454375  , 30.5       ],
       [ 6.69421875,  4.4809375 , 30.6       ],
       [ 6.71575   ,  4.5075    , 30.7       ],
       [ 6.73728125,  4.5340625 , 30.8       ],
       [ 6.7588125 ,  4.560625  , 30.9       ],
       [ 6.76957812,  4.57390625, 30.95      ],
       [ 6.78034375,  4.5871875 , 31.        ],
       [ 6.801875  ,  4.61375   , 31.1       ],
       [ 6.82340625,  4.6403125 , 31.2       ],
       [ 6.8449375 ,  4.666875  , 31.3       ],
       [ 6.86646875,  4.6934375 , 31.4       ],
       [ 6.888     ,  4.72      , 31.5       ],
       [ 6.90145312,  4.73875   , 31.559375  ],
       [ 6.91490625,  4.7575    , 31.61875   ],
       [ 6.92835938,  4.77625   , 31.678125  ],
       [ 6.9418125 ,  4.795     , 31.7375    ],
       [ 6.96871875,  4.8325    , 31.85625   ],
       [ 6.98217187,  4.85125   , 31.915625  ],
       [ 6.995625  ,  4.87      , 31.975     ],
       [ 7.02253125,  4.9075    , 32.09375   ],
       [ 7.0494375 ,  4.945     , 32.2125    ],
       [ 7.06289062,  4.96375   , 32.271875  ],
       [ 7.07634375,  4.9825    , 32.33125   ],
       [ 7.08979688,  5.00125   , 32.390625  ],
       [ 7.10325   ,  5.02      , 32.45      ],
       [ 7.11670312,  5.03875   , 32.509375  ],
       [ 7.13015625,  5.0575    , 32.56875   ],
       [ 7.1570625 ,  5.095     , 32.6875    ],
       [ 7.17051563,  5.11375   , 32.746875  ],
       [ 7.18396875,  5.1325    , 32.80625   ],
       [ 7.19742187,  5.15125   , 32.865625  ],
       [ 7.210875  ,  5.17      , 32.925     ],
       [ 7.23778125,  5.2075    , 33.04375   ],
       [ 7.25123438,  5.22625   , 33.103125  ],
       [ 7.2646875 ,  5.245     , 33.1625    ],
       [ 7.27814062,  5.26375   , 33.221875  ],
       [ 7.29159375,  5.2825    , 33.28125   ],
       [ 7.3185    ,  5.32      , 33.4       ],
       [ 7.33195313,  5.33875   , 33.459375  ],
       [ 7.34540625,  5.3575    , 33.51875   ],
       [ 7.35885937,  5.37625   , 33.578125  ],
       [ 7.3723125 ,  5.395     , 33.6375    ],
       [ 7.39921875,  5.4325    , 33.75625   ],
       [ 7.41267188,  5.45125   , 33.815625  ],
       [ 7.426125  ,  5.47      , 33.875     ],
       [ 7.43957812,  5.48875   , 33.934375  ],
       [ 7.45303125,  5.5075    , 33.99375   ],
       [ 7.4799375 ,  5.545     , 34.1125    ],
       [ 7.49339062,  5.56375   , 34.171875  ],
       [ 7.50684375,  5.5825    , 34.23125   ],
       [ 7.52029687,  5.60125   , 34.290625  ],
       [ 7.53375   ,  5.62      , 34.35      ],
       [ 7.54720313,  5.63875   , 34.409375  ],
       [ 7.56065625,  5.6575    , 34.46875   ],
       [ 7.5875625 ,  5.695     , 34.5875    ],
       [ 7.60101562,  5.71375   , 34.646875  ],
       [ 7.61446875,  5.7325    , 34.70625   ],
       [ 7.62792188,  5.75125   , 34.765625  ],
       [ 7.641375  ,  5.77      , 34.825     ],
       [ 7.66828125,  5.8075    , 34.94375   ],
       [ 7.68173437,  5.82625   , 35.003125  ],
       [ 7.6951875 ,  5.845     , 35.0625    ],
       [ 7.70864063,  5.86375   , 35.121875  ],
       [ 7.72209375,  5.8825    , 35.18125   ],
       [ 7.749     ,  5.92      , 35.3       ],
       [ 7.76629688,  5.9459375 , 35.3765625 ],
       [ 7.78359375,  5.971875  , 35.453125  ],
       [ 7.80089063,  5.9978125 , 35.5296875 ],
       [ 7.8181875 ,  6.02375   , 35.60625   ],
       [ 7.83548438,  6.0496875 , 35.6828125 ],
       [ 7.85278125,  6.075625  , 35.759375  ],
       [ 7.87007813,  6.1015625 , 35.8359375 ],
       [ 7.887375  ,  6.1275    , 35.9125    ],
       [ 7.90467188,  6.1534375 , 35.9890625 ],
       [ 7.92196875,  6.179375  , 36.065625  ],
       [ 7.93926562,  6.2053125 , 36.1421875 ],
       [ 7.9565625 ,  6.23125   , 36.21875   ],
       [ 7.97385937,  6.2571875 , 36.2953125 ],
       [ 7.99115625,  6.283125  , 36.371875  ],
       [ 8.00845313,  6.3090625 , 36.4484375 ],
       [ 8.02575   ,  6.335     , 36.525     ],
       [ 8.04304687,  6.3609375 , 36.6015625 ],
       [ 8.06034375,  6.386875  , 36.678125  ],
       [ 8.07764063,  6.4128125 , 36.7546875 ],
       [ 8.0949375 ,  6.43875   , 36.83125   ],
       [ 8.11223437,  6.4646875 , 36.9078125 ],
       [ 8.12953125,  6.490625  , 36.984375  ],
       [ 8.14682813,  6.5165625 , 37.0609375 ],
       [ 8.164125  ,  6.5425    , 37.1375    ],
       [ 8.18142187,  6.5684375 , 37.2140625 ],
       [ 8.19871875,  6.594375  , 37.290625  ],
       [ 8.21601563,  6.6203125 , 37.3671875 ],
       [ 8.2333125 ,  6.64625   , 37.44375   ],
       [ 8.25060937,  6.6721875 , 37.5203125 ],
       [ 8.26790625,  6.698125  , 37.596875  ],
       [ 8.28520313,  6.7240625 , 37.6734375 ],
       [ 8.3025    ,  6.75      , 37.75      ],
       [ 8.31979687,  6.7759375 , 37.8265625 ],
       [ 8.33709375,  6.801875  , 37.903125  ],
       [ 8.35439063,  6.8278125 , 37.9796875 ],
       [ 8.3716875 ,  6.85375   , 38.05625   ],
       [ 8.38898437,  6.8796875 , 38.1328125 ],
       [ 8.40628125,  6.905625  , 38.209375  ],
       [ 8.42357813,  6.9315625 , 38.2859375 ],
       [ 8.440875  ,  6.9575    , 38.3625    ],
       [ 8.45817187,  6.9834375 , 38.4390625 ],
       [ 8.47546875,  7.009375  , 38.515625  ],
       [ 8.49276563,  7.0353125 , 38.5921875 ],
       [ 8.5100625 ,  7.06125   , 38.66875   ],
       [ 8.52735937,  7.0871875 , 38.7453125 ],
       [ 8.54465625,  7.113125  , 38.821875  ],
       [ 8.56195313,  7.1390625 , 38.8984375 ],
       [ 8.57925   ,  7.165     , 38.975     ],
       [ 8.59654687,  7.1909375 , 39.0515625 ],
       [ 8.61384375,  7.216875  , 39.128125  ],
       [ 8.63114063,  7.2428125 , 39.2046875 ],
       [ 8.6484375 ,  7.26875   , 39.28125   ],
       [ 8.66573437,  7.2946875 , 39.3578125 ],
       [ 8.68303125,  7.320625  , 39.434375  ],
       [ 8.70032813,  7.3465625 , 39.5109375 ],
       [ 8.717625  ,  7.3725    , 39.5875    ],
       [ 8.73492187,  7.3984375 , 39.6640625 ],
       [ 8.75221875,  7.424375  , 39.740625  ],
       [ 8.76951563,  7.4503125 , 39.8171875 ],
       [ 8.7868125 ,  7.47625   , 39.89375   ],
       [ 8.80410937,  7.5021875 , 39.9703125 ],
       [ 8.82140625,  7.528125  , 40.046875  ],
       [ 8.83870313,  7.5540625 , 40.1234375 ],
       [ 8.856     ,  7.58      , 40.2       ],
       [ 8.87903125,  7.619375  , 40.296875  ],
       [ 8.89054688,  7.6390625 , 40.3453125 ],
       [ 8.9020625 ,  7.65875   , 40.39375   ],
       [ 8.92509375,  7.698125  , 40.490625  ],
       [ 8.948125  ,  7.7375    , 40.5875    ],
       [ 8.95964063,  7.7571875 , 40.6359375 ],
       [ 8.97115625,  7.776875  , 40.684375  ],
       [ 8.9941875 ,  7.81625   , 40.78125   ],
       [ 9.01721875,  7.855625  , 40.878125  ],
       [ 9.02873438,  7.8753125 , 40.9265625 ],
       [ 9.04025   ,  7.895     , 40.975     ],
       [ 9.06328125,  7.934375  , 41.071875  ],
       [ 9.0863125 ,  7.97375   , 41.16875   ],
       [ 9.10934375,  8.013125  , 41.265625  ],
       [ 9.12085938,  8.0328125 , 41.3140625 ],
       [ 9.132375  ,  8.0525    , 41.3625    ],
       [ 9.15540625,  8.091875  , 41.459375  ],
       [ 9.1784375 ,  8.13125   , 41.55625   ],
       [ 9.18995313,  8.1509375 , 41.6046875 ],
       [ 9.20146875,  8.170625  , 41.653125  ],
       [ 9.2245    ,  8.21      , 41.75      ],
       [ 9.2705625 ,  8.28875   , 41.94375   ],
       [ 9.316625  ,  8.3675    , 42.1375    ],
       [ 9.3626875 ,  8.44625   , 42.33125   ],
       [ 9.40875   ,  8.525     , 42.525     ],
       [ 9.4548125 ,  8.60375   , 42.71875   ],
       [ 9.500875  ,  8.6825    , 42.9125    ],
       [ 9.5469375 ,  8.76125   , 43.10625   ],
       [ 9.593     ,  8.84      , 43.3       ],
       [ 9.6390625 ,  8.91875   , 43.49375   ],
       [ 9.685125  ,  8.9975    , 43.6875    ],
       [ 9.7311875 ,  9.07625   , 43.88125   ],
       [ 9.77725   ,  9.155     , 44.075     ],
       [ 9.8233125 ,  9.23375   , 44.26875   ],
       [ 9.869375  ,  9.3125    , 44.4625    ],
       [ 9.9154375 ,  9.39125   , 44.65625   ],
       [ 9.9615    ,  9.47      , 44.85      ],
       [10.0075625 ,  9.54875   , 45.04375   ]])
    
    lam=A[:,0]
    kap=A[:,2]
    ref=A[:,1]
    if lambdaX<lam[0] or lambdaX>lam[-1]:
            y=0
    else:
        ind=where(lam>=lambdaX)[0]
        wave_R=lam[ind[0]]
        if ind[0]==1:
            n=ref[0]
            k=kap[0]
        else:
            wave_L=lam[ind[0]-1]
            n=(ref[ind[0]]-ref[ind[0]-1])/(wave_R-wave_L)*(lambdaX-wave_L)+ref[ind[0]-1];
            k=(kap[ind[0]]-kap[ind[0]-1])/(wave_R-wave_L)*(lambdaX-wave_L)+kap[ind[0]-1];
            
    return (n+ complex(0,1) *k)**2








def Matrix_Gen_TE(e_m, e_d, f1, f2, Period, e1,lambdaX, theta, Num_ord):
    j = complex(0,1)
    ordMin=-Num_ord;
    ordMax=Num_ord;
    ordDif=2*Num_ord+1;
    i = arange(ordMin,ordMax+1)    #-40 to 40
    k0 = 2*pi/lambdaX;
    kxi = k0*(sqrt(e1)*sin(theta)+i*lambdaX/Period); #kxi (1_by_i vector)
    Kx2 = diag(power(kxi/k0,2)); #diagonal matrix with kxi/k0 (#i_by_#i matrix)

    #Fourier expansion of the dielectric function in grating
    #region: positive (1 to 80)
    h = arange(1,ordMax-ordMin+1)
    epsilonp = j*(exp(-j*h*2*pi*f2)-exp(-j*h*2*pi*f1))/(2*pi*h) *(e_m-e_d);
 
    #0th order
    epsilon0 = (f2-f1)*(e_m-e_d)+e_d;
 
    #Fourier expansion of the dielectric function in grating
    #region: negative (-80 to -1)
    h = arange(ordMin-ordMax,-1+1)
    epsilonn = j*(exp(-j*h*2*pi*f2)-exp(-j*h*2*pi*f1))/(2*pi*h) *(e_m-e_d);
 
    #Fourier expansion of the dielectric function in grating region
    epsilonG =hstack( [epsilonn, epsilon0, epsilonp])    #(-80 to -1, 0, 1 to 80)

    #matrix of the dielectric function of grating based on Fourier
    #components
    inE = arange(ordMax-ordMin+2,(ordMax-ordMin+2+2*Num_ord)+1 )-1;
    E = zeros([ordMax-ordMin+1,len(inE)],dtype = complex)
    for i in range(1,ordMax-ordMin+2):
        E[i-1,:] = epsilonG[ordMax-ordMin+2-i-1:ordMax-ordMin+2-i+2*Num_ord ]
    
    #Note E(1,:)=[0, ..., 80]
    #     E(2,:)=[-1, ..., 79]
    #     E(81,:)=[-80, ..., 0]

    I = eye(ordDif); #Unit matrix
    A = Kx2-E;
    Q,W =linalg.eig(A);   #Q:eigenvalue, W:corresponding vector
    Q = diag(Q)
    Q = sqrt(Q);
    V = W@Q;
    
    
    
    
    
    return Q,V,W



def RCWA_Multi_TE(N, e_m, e_d, f1, f2, Period, d, e, lambdaX, theta, Num_ord):
    j = complex(0,1)
    ordMax = Num_ord;
    ordMin = -Num_ord;
    ordDif = ordMax-ordMin+1; #total order of diffraction including 0th
    i = arange( ordMin,ordMax+1 )    #-40 to 40

    # Matrix needed for calculation
    I = eye(ordDif);
    Dirac_del=zeros([ordDif,1]);
    Dirac_del[Num_ord]=1;

    k0 = 2*pi/lambdaX;
    kxi = k0*(sqrt(e[0])*sin(theta)+i*lambdaX/Period[0]); #kxi (1_by_i vector)

    Q = zeros([N],dtype = object)
    V = zeros([N],dtype = object)
    W = zeros([N],dtype = object)
    X = zeros([N],dtype = object)
    O = zeros([N],dtype = object)
    for ind in range(N):
        Q[ind],V[ind],W[ind]=Matrix_Gen_TE(e_m[ind], e_d[ind], f1[ind], f2[ind], Period[ind], e[0], lambdaX, theta, Num_ord)
        X[ind] = diag(exp(-k0*d[ind]*linalg.eig(Q[ind])[0] ));
        O[ind] = vstack( [ hstack( [ W[ind], W[ind] ]) , hstack([ V[ind], -V[ind] ]) ] )

    kz1i = e[0]*k0*k0-kxi**2
    Kz1 =array( [cmath.sqrt(x) for x in kz1i])
    Kz3i = e[1]*k0*k0-kxi**2  
    Kz3 = array( [cmath.sqrt(x) for x in Kz3i])
    
    #From here, we solve the matrix formulation
    # TE
    Yinc = diag(Kz1/k0);   #First medium: air (or dielectric)
    Ysub = diag(Kz3/k0);   #Last medium: substrate
    
    f = zeros([N+1],dtype = object)
    g = zeros([N+1],dtype = object)
    a = zeros([N],dtype = object)
    b = zeros([N],dtype = object)
    
    f[N]=deepcopy( I )
    g[N]=j*Ysub;
    for ind in arange(N-1,-1,-1):
        mt1 = O[ind]
        mt1inv = linalg.inv(mt1)
        mat2 = vstack( [f[ind+1], g[ind+1]] )
        Mat_ab = mt1inv@ mat2
        maind = Mat_ab[0:ordDif,:]
        a[ind] = maind
        mbind = Mat_ab[ordDif:2*ordDif+1,:]
        b[ind] = mbind
        
        f[ind] = W[ind]@(I+X[ind]@a[ind]@linalg.inv(b[ind])@X[ind])
        g[ind] = V[ind]@(-I+X[ind]@a[ind]@linalg.inv(b[ind])@X[ind])
    T1 = linalg.inv(j*Yinc@f[0]+g[0])@(j*Yinc@Dirac_del+j*sqrt(e[0])*cos(theta)*Dirac_del);
    R = f[0]@T1-Dirac_del;


    T=deepcopy(T1)
    for ind in range( 1 , N+1):
        T = linalg.inv(b[ind-1])@X[ind-1]@T
    
   
    
    DEr =( conj(R.T*conj(R).T*real(Kz1)).T/(k0*sqrt(e[0])*cos(theta)) )
    DEt = conj(T.T*conj(T).T*real(Kz3)).T/(k0*sqrt(e[0])*cos(theta))
   
    Ref=np.sum(DEr);
    Tran=np.sum(DEt);
    
    here = 1

    
    return Ref,Tran




def Matrix_Gen_TM(e_m, e_d, f1, f2, Period, e1,lambdaX, theta, Num_ord):
    j = complex(0,1)
    ordMin=-Num_ord;
    ordMax=Num_ord;
    ordDif=2*Num_ord+1;
    i = arange(ordMin,ordMax+1)    #-40 to 40
    k0 = 2*pi/lambdaX;
    kxi = k0*(sqrt(e1)*sin(theta)+i*lambdaX/Period); #kxi (1_by_i vector)
    Kx = diag(kxi/k0); #diagonal matrix with kxi/k0 (#i_by_#i matrix)

    #Fourier expansion of the dielectric function in grating
    #region: positive (1 to 80)
    h = arange(1,ordMax-ordMin+1)
    epsilonp = j*(exp(-j*h*2*pi*f2)-exp(-j*h*2*pi*f1))/(2*pi*h) *(e_m-e_d);
    epsilonp_rec = j*(exp(-j*h*2*pi*f2)-exp(-j*h*2*pi*f1))/(2*pi*h) *(1/e_m-1/e_d)
    #0th order
    epsilon0 = (f2-f1)*(e_m-e_d)+e_d;
    epsilon0_rec = (f2-f1)*(1/e_m-1/e_d)+1/e_d;
    #Fourier expansion of the dielectric function in grating
    #region: negative (-80 to -1)
    h = arange(ordMin-ordMax,-1+1)
    epsilonn = j*(exp(-j*h*2*pi*f2)-exp(-j*h*2*pi*f1))/(2*pi*h) *(e_m-e_d);
    epsilonn_rec = j*(exp(-j*h*2*pi*f2)-exp(-j*h*2*pi*f1))/(2*pi*h) *(1/e_m-1/e_d)
    #Fourier expansion of the dielectric function in grating region
    epsilonG =hstack( [epsilonn, epsilon0, epsilonp])    #(-80 to -1, 0, 1 to 80)
    epsilonG_rec =hstack( [epsilonn_rec, epsilon0_rec, epsilonp_rec])    #(-80 to -1, 0, 1 to 80)

    #matrix of the dielectric function of grating based on Fourier
    #components
    inE = arange(ordMax-ordMin+2,(ordMax-ordMin+2+2*Num_ord)+1 )-1;
    E = zeros([ordMax-ordMin+1,len(inE)],dtype = complex)
    E_rec = zeros([ordMax-ordMin+1,len(inE)],dtype = complex)
    for i in range(1,ordMax-ordMin+2):
        E[i-1,:] = epsilonG[ordMax-ordMin+2-i-1:ordMax-ordMin+2-i+2*Num_ord ]
        E_rec[i-1,:] = epsilonG_rec[ordMax-ordMin+2-i-1:ordMax-ordMin+2-i+2*Num_ord ]
    
    #Note E(1,:)=[0, ..., 80]
    #     E(2,:)=[-1, ..., 79]
    #     E(81,:)=[-80, ..., 0]

    I = eye(ordDif); #Unit matrix
    B = Kx@linalg.inv(E)@Kx-I
    A = linalg.inv(E_rec)@B
    Q,W =linalg.eig(A);   #Q:eigenvalue, W:corresponding vector
    Q = diag(Q)
    Q = sqrt(Q);
    V = E_rec@W@Q;
    
    
    
    
    
    return Q,V,W,E







def RCWA_Multi_TM(N, e_m, e_d, f1, f2, Period, d, e, lambdaX, theta, Num_ord):
    j = complex(0,1)
    ordMax = Num_ord;
    ordMin = -Num_ord;
    ordDif = ordMax-ordMin+1; #total order of diffraction including 0th
    i = arange( ordMin,ordMax+1 )    #-40 to 40

    # Matrix needed for calculation
    I = eye(ordDif);
    Dirac_del=zeros([ordDif,1]);
    Dirac_del[Num_ord]=1;

    k0 = 2*pi/lambdaX;
    kxi = k0*(sqrt(e[0])*sin(theta)+i*lambdaX/Period[0]); #kxi (1_by_i vector)

    Q = zeros([N],dtype = object)
    V = zeros([N],dtype = object)
    W = zeros([N],dtype = object)
    E = zeros([N],dtype = object)
    X = zeros([N],dtype = object)
    O = zeros([N],dtype = object)
    for ind in range(N):
        Q[ind],V[ind],W[ind],E[ind]=Matrix_Gen_TM(e_m[ind], e_d[ind], f1[ind], f2[ind], Period[ind], e[0], lambdaX, theta, Num_ord)
        X[ind] = diag(exp(-k0*d[ind]*linalg.eig(Q[ind])[0] ));
        O[ind] = vstack( [ hstack( [ W[ind], W[ind] ]) , hstack([ V[ind], -V[ind] ]) ] )

    kz1i = e[0]*k0*k0-kxi**2
    Kz1 =array( [cmath.sqrt(x) for x in kz1i])
    Kz3i = e[1]*k0*k0-kxi**2  
    Kz3 = array( [cmath.sqrt(x) for x in Kz3i])
    
    #From here, we solve the matrix formulation
    # TE
    Yinc = diag(Kz1/k0);   #First medium: air (or dielectric)
    Ysub = diag(Kz3/k0);   #Last medium: substrate
    
    f = zeros([N+1],dtype = object)
    g = zeros([N+1],dtype = object)
    a = zeros([N],dtype = object)
    b = zeros([N],dtype = object)
    
    f[N]=deepcopy( I )
    g[N]=j*Ysub;
    for ind in arange(N-1,-1,-1):
        mt1 = O[ind]
        mt1inv = linalg.inv(mt1)
        mat2 = vstack( [f[ind+1], g[ind+1]] )
        Mat_ab = mt1inv@ mat2
        maind = Mat_ab[0:ordDif,:]
        a[ind] = maind
        mbind = Mat_ab[ordDif:2*ordDif+1,:]
        b[ind] = mbind
        
        f[ind] = W[ind]@(I+X[ind]@a[ind]@linalg.inv(b[ind])@X[ind])
        g[ind] = V[ind]@(-I+X[ind]@a[ind]@linalg.inv(b[ind])@X[ind])
    T1 = linalg.inv(j*Yinc@f[0]+g[0])@(j*Yinc@Dirac_del+j*sqrt(e[0])*cos(theta)*Dirac_del);
    R = f[0]@T1-Dirac_del;


    T= deepcopy(T1)
    for ind in range( 1 , N+1):
        T = linalg.inv(b[ind-1])@X[ind-1]@T
    
    DEr =( conj(R.T*conj(R).T*real(Kz1)).T/(k0*sqrt(e[0])*cos(theta)) )
    DEt = conj(T.T*conj(T).T*real(Kz3)).T/(k0*sqrt(e[0])*cos(theta))
   
    Ref=np.sum(DEr);
    Tran=np.sum(DEt);
    
    here = 1



    return Ref,Tran









